<div class="login-split-container">

    <!-- Left Side: Recent Workspaces -->
    <div class="login-form-side">
        <div class="login-card">

            <!-- Header / Brand -->
            <header class="brand-header">
                <div class="brand-logo" routerLink="/meta" role="link" aria-label="Quilix Home">
                    <i class="bi bi-feather" aria-hidden="true"></i>
                    <span>Quilix</span>
                </div>
                <button type="button" class="import-btn" (click)="$event.stopPropagation(); openImport()"
                    aria-label="Import Backup">
                    <i class="bi bi-cloud-arrow-down" aria-hidden="true"></i>
                </button>
            </header>

            <div class="header-text">
                <h1>Recent Activity</h1>
                <p class="subtitle">Select a workspace to resume your flow.</p>
            </div>

            <div class="scroll-area">
                @if (loading) {
                <div class="loading-state">
                    <app-spinner [size]="28" />
                </div>
                } @else {
                @if (workspaces.length === 0) {
                <div class="empty-state">
                    <i class="bi bi-clock-history"></i>
                    <p>No recent workspaces found.</p>
                    <button class="create-first-btn" routerLink="/create-workspace">Create your first workspace</button>
                </div>
                } @else {
                <ul class="workspace-list">
                    @for (ws of workspaces; track ws.id) {
                    <li class="workspace-card" [class.confirming]="deletingWorkspaceId === ws.id">

                        @if (deletingWorkspaceId !== ws.id) {
                        <div class="ws-main" (click)="continueWorkspace(ws)"
                            [class.loading]="loadingWorkspaceId === ws.id" role="button"
                            [attr.aria-label]="'Continue ' + ws.name" [attr.aria-busy]="loadingWorkspaceId === ws.id">
                            <div class="ws-icon" [style.background]="getAvatarColor(ws.id)" aria-hidden="true">
                                <i class="bi {{ getAvatarIcon(ws.id) }}"></i>
                            </div>
                            <div class="ws-meta">
                                <strong class="truncate">{{ ws.name }}</strong>
                                <small>{{ ws.role | titlecase }} â€¢ {{ ws.lastActiveAt | timeAgo }}</small>
                            </div>
                            @if (loadingWorkspaceId === ws.id) {
                            <div class="ws-card-loading">
                                <app-spinner [size]="20" />
                            </div>
                            }
                        </div>

                        <button class="delete-action" (click)="requestDelete(ws); $event.stopPropagation()"
                            aria-label="Move to trash">
                            <i class="bi bi-trash" aria-hidden="true"></i>
                        </button>
                        } @else {
                        <div class="ws-confirm">
                            <span class="confirm-text">Move to Trash?</span>
                            <div class="confirm-actions">
                                <button class="confirm-yes" (click)="confirmDelete(ws)">
                                    @if (loadingWorkspaceId === ws.id) { <app-spinner [size]="14" /> }
                                    @else { Yes }
                                </button>
                                <button class="confirm-no" (click)="cancelDelete()">Cancel</button>
                            </div>
                        </div>
                        }
                    </li>
                    }
                </ul>
                }
                }
            </div>

            <div class="footer-actions">
                <button class="add-new-btn" routerLink="/create-workspace">
                    <i class="bi bi-plus-lg"></i>
                    <span>New Workspace</span>
                </button>
            </div>

        </div>
    </div>

    <!-- Right Side: Visual -->
    <div class="login-visual-side">
        <app-workspace-visual></app-workspace-visual>
    </div>

</div>