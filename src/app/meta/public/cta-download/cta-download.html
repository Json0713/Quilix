<section class="cta-download-section" aria-label="Install Quilix App">
    <div class="download-container" data-scroll="fade-up">

        <!-- Header Content (Dynamic based on state) -->
        <header class="download-header">
            <div class="dl-tag">
                @if (state.installed()) {
                <span class="dl-badge success"><i class="bi bi-patch-check-fill"></i> System Ready</span>
                } @else {
                <span class="dl-badge"><i class="bi bi-cloud-arrow-down-fill"></i> Install as App</span>
                }
            </div>

            <h2 class="dl-title">
                @if (state.installed()) {
                Welcome to your <span>Workspace.</span>
                } @else {
                Take Quilix <span>Everywhere.</span>
                }
            </h2>
            <p class="dl-description">
                @if (state.installed()) {
                You're all set! Quilix is installed and ready to empower your productivity. Launch it anytime from your
                applications folder or home screen for the full, immersive experience.
                } @else {
                Install Quilix directly onto your device as a native-feeling PWA. Launch instantly from your home
                screen, work seamlessly offline, and experience the full power of your workspace â€” no browser tab
                needed.
                }
            </p>
        </header>

        <!-- Sky Visual (full-width, like marquee) -->
        <div class="sky-container">
            <div class="sky-track">

                <!-- Massive Airplane (centered focal element) -->
                <div class="airplane-zone">
                    <svg class="airplane-svg" viewBox="0 0 300 120" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="planeBody" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#f8fafc" />
                                <stop offset="100%" stop-color="#cbd5e1" />
                            </linearGradient>
                            <linearGradient id="planeAccent" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#38bdf8" />
                                <stop offset="100%" stop-color="#0ea5e9" />
                            </linearGradient>
                            <filter id="planeShadow" x="-20%" y="-20%" width="140%" height="140%">
                                <feGaussianBlur in="SourceAlpha" stdDeviation="3" />
                                <feOffset dx="0" dy="4" result="offsetblur" />
                                <feComponentTransfer>
                                    <feFuncA type="linear" slope="0.3" />
                                </feComponentTransfer>
                                <feMerge>
                                    <feMergeNode />
                                    <feMergeNode in="SourceGraphic" />
                                </feMerge>
                            </filter>
                        </defs>

                        <g filter="url(#planeShadow)">
                            <!-- Fuselage (Long and Sleek) -->
                            <path d="M40,55 Q150,45 270,55 L285,55 Q295,55 290,60 L280,65 Q160,75 40,65 Z"
                                fill="url(#planeBody)" />

                            <!-- Professional Cockpit -->
                            <path d="M255,54 Q275,54 280,57 L278,61 Q272,64 255,62 Z" fill="#1e293b" opacity="0.9" />

                            <!-- Swept Back Wings (Fixed Orientation) -->
                            <!-- Top Wing (Swept back towards tail) -->
                            <path d="M110,50 L180,20 Q195,15 190,25 L145,52 Z" fill="#e2e8f0" />
                            <!-- Bottom Wing (Swept back towards tail) -->
                            <path d="M110,68 L180,105 Q195,110 190,100 L145,66 Z" fill="#94a3b8" />

                            <!-- Engines -->
                            <rect x="135" y="24" width="28" height="12" rx="6" fill="#475569" />
                            <rect x="135" y="88" width="28" height="12" rx="6" fill="#475569" />

                            <!-- Tail Fin (Vertical) -->
                            <path d="M42,55 L35,10 Q32,0 45,10 L65,55 Z" fill="url(#planeAccent)" />

                            <!-- Horizontal Stabilizers -->
                            <path d="M42,55 L15,45 Q10,42 20,48 L45,55 Z" fill="#94a3b8" />
                            <path d="M42,65 L15,75 Q10,78 20,72 L45,65 Z" fill="#475569" />

                            <!-- Window Lights -->
                            <g fill="#0ea5e9" opacity="0.6">
                                <circle cx="100" cy="58" r="1.5" />
                                <circle cx="120" cy="58" r="1.5" />
                                <circle cx="140" cy="58" r="1.5" />
                                <circle cx="160" cy="58" r="1.5" />
                                <circle cx="180" cy="58" r="1.5" />
                                <circle cx="200" cy="58" r="1.5" />
                                <circle cx="220" cy="58" r="1.5" />
                                <circle cx="240" cy="58" r="1.5" />
                            </g>
                        </g>

                        <!-- Engine Trails (Pulsing) -->
                        <g class="trails">
                            <line x1="30" y1="58" x2="-20" y2="58" stroke="#38bdf8" stroke-width="2" class="trail t1" />
                            <line x1="30" y1="62" x2="-10" y2="62" stroke="#0ea5e9" stroke-width="1.5"
                                class="trail t2" />
                        </g>
                    </svg>
                </div>

                <!-- State-Aware Button Area -->
                <div class="sky-btn-zone">
                    @if (state.installed()) {
                    <div class="installed-badge">
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Already Installed</span>
                    </div>
                    } @else {
                    <button class="sky-install-btn" (click)="install()" [disabled]="!state.canInstall()">
                        <i class="bi bi-download"></i>
                        Install Quilix
                    </button>
                    @if (!state.canInstall()) {
                    <span class="sky-hint">Open in a supported browser to install</span>
                    }
                    }
                </div>

                <!-- Infinite Noisy Clouds Layer (Seamless 3-set loop) -->
                <div class="clouds-layer">
                    <div class="clouds-marquee">
                        <!-- Set 1 -->
                        <div class="cloud-chunk">
                            <svg class="cloud big" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.8">
                                    <circle cx="50" cy="50" r="30" />
                                    <circle cx="80" cy="40" r="35" />
                                    <circle cx="120" cy="45" r="40" />
                                    <circle cx="150" cy="55" r="30" />
                                    <circle cx="90" cy="65" r="30" />
                                </g>
                            </svg>
                            <svg class="cloud sm" viewBox="0 0 150 80" style="margin-left: -40px;">
                                <g fill="currentColor" opacity="0.6">
                                    <circle cx="40" cy="40" r="20" />
                                    <circle cx="65" cy="35" r="25" />
                                    <circle cx="95" cy="45" r="22" />
                                </g>
                            </svg>
                            <svg class="cloud noisy" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.7">
                                    <circle cx="30" cy="50" r="15" />
                                    <circle cx="50" cy="40" r="25" />
                                    <circle cx="80" cy="45" r="30" />
                                    <circle cx="110" cy="35" r="28" />
                                    <circle cx="140" cy="50" r="25" />
                                    <circle cx="170" cy="60" r="18" />
                                    <circle cx="100" cy="70" r="25" />
                                </g>
                            </svg>
                        </div>
                        <!-- Set 2 -->
                        <div class="cloud-chunk" aria-hidden="true">
                            <svg class="cloud big" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.8">
                                    <circle cx="50" cy="50" r="30" />
                                    <circle cx="80" cy="40" r="35" />
                                    <circle cx="120" cy="45" r="40" />
                                    <circle cx="150" cy="55" r="30" />
                                    <circle cx="90" cy="65" r="30" />
                                </g>
                            </svg>
                            <svg class="cloud sm" viewBox="0 0 150 80" style="margin-left: -40px;">
                                <g fill="currentColor" opacity="0.6">
                                    <circle cx="40" cy="40" r="20" />
                                    <circle cx="65" cy="35" r="25" />
                                    <circle cx="95" cy="45" r="22" />
                                </g>
                            </svg>
                            <svg class="cloud noisy" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.7">
                                    <circle cx="30" cy="50" r="15" />
                                    <circle cx="50" cy="40" r="25" />
                                    <circle cx="80" cy="45" r="30" />
                                    <circle cx="110" cy="35" r="28" />
                                    <circle cx="140" cy="50" r="25" />
                                    <circle cx="170" cy="60" r="18" />
                                    <circle cx="100" cy="70" r="25" />
                                </g>
                            </svg>
                        </div>
                        <!-- Set 3 -->
                        <div class="cloud-chunk" aria-hidden="true">
                            <svg class="cloud big" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.8">
                                    <circle cx="50" cy="50" r="30" />
                                    <circle cx="80" cy="40" r="35" />
                                    <circle cx="120" cy="45" r="40" />
                                    <circle cx="150" cy="55" r="30" />
                                    <circle cx="90" cy="65" r="30" />
                                </g>
                            </svg>
                            <svg class="cloud sm" viewBox="0 0 150 80" style="margin-left: -40px;">
                                <g fill="currentColor" opacity="0.6">
                                    <circle cx="40" cy="40" r="20" />
                                    <circle cx="65" cy="35" r="25" />
                                    <circle cx="95" cy="45" r="22" />
                                </g>
                            </svg>
                            <svg class="cloud noisy" viewBox="0 0 200 100">
                                <g fill="currentColor" opacity="0.7">
                                    <circle cx="30" cy="50" r="15" />
                                    <circle cx="50" cy="40" r="25" />
                                    <circle cx="80" cy="45" r="30" />
                                    <circle cx="110" cy="35" r="28" />
                                    <circle cx="140" cy="50" r="25" />
                                    <circle cx="170" cy="60" r="18" />
                                    <circle cx="100" cy="70" r="25" />
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Background Blurs -->
    <div class="dl-blur-left"></div>
    <div class="dl-blur-right"></div>
</section>