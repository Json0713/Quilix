<section class="cta-download-section" aria-label="Install Quilix App">
    <div class="download-container" data-scroll="fade-up">

        <!-- Header Content -->
        <header class="download-header">
            <div class="dl-tag">
                @if (state.installed()) {
                <span class="dl-badge success"><i class="bi bi-patch-check-fill"></i> System Ready</span>
                } @else {
                <span class="dl-badge"><i class="bi bi-cloud-arrow-down-fill"></i> Install as App</span>
                }
            </div>

            <h2 class="dl-title">
                @if (state.installed()) {
                Welcome to your <span>Workspace.</span>
                } @else {
                Take Quilix <span>Everywhere.</span>
                }
            </h2>
            <p class="dl-description">
                @if (state.installed()) {
                You're all set! Quilix is installed and ready to empower your productivity. Launch it anytime from your
                applications folder or home screen for the full, immersive experience.
                } @else {
                Install Quilix directly onto your device as a native-feeling PWA. Launch instantly from your home
                screen, work seamlessly offline, and experience the full power of your workspace â€” no browser tab
                needed.
                }
            </p>
        </header>

        <!-- Sky Visual Container -->
        <div class="sky-container">
            <div class="sky-track">

                <!-- Massive Commercial Airliner (Centered) -->
                <div class="airplane-zone">
                    <!-- Wind speed streaks -->
                    <div class="wind-streaks">
                        <span class="streak s1"></span>
                        <span class="streak s2"></span>
                        <span class="streak s3"></span>
                    </div>

                    <svg class="airplane-svg" viewBox="0 0 400 150" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="airlinerBody" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#ffffff" />
                                <stop offset="100%" stop-color="#e2e8f0" />
                            </linearGradient>
                            <linearGradient id="airlinerWings" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#cbd5e1" />
                                <stop offset="100%" stop-color="#94a3b8" />
                            </linearGradient>
                            <linearGradient id="windowGlow" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stop-color="#38bdf8" />
                                <stop offset="100%" stop-color="#0284c7" />
                            </linearGradient>
                        </defs>

                        <!-- Fuselage (Centered Wings Reference) -->
                        <path
                            d="M40,65 C120,55 300,55 380,65 L395,72 C400,75 400,80 395,83 L380,90 C300,100 120,100 40,90 L30,85 Q25,80 30,75 L40,65 Z"
                            fill="url(#airlinerBody)" />

                        <!-- Cockpit -->
                        <path d="M355,66 Q375,66 385,73 L375,76 Q365,74 355,74 Z" fill="#1e293b" />

                        <!-- Far Wing (Top, Adjusted Centering, Swept Back) -->
                        <path d="M140,70 L90,30 Q80,20 100,22 L180,68 Z" fill="#94a3b8" />

                        <!-- Vertical Stabilizer (Tail) -->
                        <path d="M60,65 L35,15 Q30,5 55,15 L100,65 Z" fill="#0ea5e9" />
                        <path d="M55,25 Q45,15 65,35 L80,55 L65,55 Z" fill="#38bdf8" opacity="0.6" />

                        <!-- Near Wing (Bottom, Centered on Fuselage, Swept Back) -->
                        <path d="M140,82 L80,130 Q70,140 100,135 L220,90 Z" fill="url(#airlinerWings)" />

                        <!-- Engines -->
                        <path d="M130,110 Q130,100 165,102 L165,118 Q130,120 130,110 Z" fill="#475569" />
                        <path d="M135,40 Q135,33 160,35 L160,47 Q135,49 135,40 Z" fill="#334155" />

                        <!-- Windows -->
                        <g fill="url(#windowGlow)" opacity="0.5">
                            <rect x="80" y="74" width="3" height="4" rx="1.5" />
                            <rect x="92" y="74" width="3" height="4" rx="1.5" />
                            <rect x="104" y="74" width="3" height="4" rx="1.5" />
                            <rect x="116" y="74" width="3" height="4" rx="1.5" />
                            <rect x="128" y="74" width="3" height="4" rx="1.5" />
                            <rect x="140" y="74" width="3" height="4" rx="1.5" />
                            <rect x="152" y="74" width="3" height="4" rx="1.5" />
                            <rect x="164" y="74" width="3" height="4" rx="1.5" />
                            <rect x="176" y="74" width="3" height="4" rx="1.5" />
                            <rect x="188" y="74" width="3" height="4" rx="1.5" />
                        </g>

                        <!-- Engine Trails -->
                        <g class="trails">
                            <line x1="30" y1="75" x2="-20" y2="75" stroke="#38bdf8" stroke-width="2.5"
                                class="trail t1" />
                            <line x1="30" y1="83" x2="-10" y2="83" stroke="#0ea5e9" stroke-width="1.8"
                                class="trail t2" />
                        </g>
                    </svg>
                </div>

                <!-- Interactive Button Area -->
                <div class="sky-btn-zone">
                    @if (state.installed()) {
                    <div class="installed-badge">
                        <i class="bi bi-check-circle-fill"></i>
                        <span>Already Installed</span>
                    </div>
                    } @else {
                    <button class="sky-install-btn" (click)="install()" [disabled]="!state.installPromptAvailable()">
                        <i class="bi bi-download"></i>
                        Install Quilix
                    </button>
                    @if (!state.installPromptAvailable() && state.platform() !== 'ios') {
                    <span class="sky-hint">Open in a supported browser to install</span>
                    }
                    @if (state.platform() === 'ios') {
                    <span class="sky-hint">Tap share and <strong>Add to Home Screen</strong></span>
                    }
                    }
                </div>

                <!-- Dense Trough Clouds (Infinite Loop, Moved Higher) -->
                <div class="clouds-layer">
                    <div class="clouds-marquee">
                        <!-- Set 1 -->
                        <div class="cloud-chunk">
                            <svg class="cloud big" viewBox="0 0 200 60">
                                <path d="M0,60 L200,60 L200,45 Q180,20 150,30 Q120,5 90,25 Q60,10 30,35 Q10,40 0,60 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud massive" viewBox="0 0 300 80" style="margin-left: -80px;">
                                <path d="M0,80 L300,80 L300,55 Q260,20 210,40 Q160,5 110,45 Q60,15 30,55 Q10,65 0,80 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud medium" viewBox="0 0 160 50" style="margin-left: -70px;">
                                <path d="M0,50 L160,50 L160,35 Q130,15 100,25 Q70,5 40,30 Q10,35 0,50 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud small" viewBox="0 0 100 40" style="margin-left: -50px;">
                                <path d="M0,40 L100,40 L100,25 Q80,10 50,20 Q20,10 0,40 Z" fill="currentColor" />
                            </svg>
                            <svg class="cloud big" viewBox="0 0 200 60" style="margin-left: -60px;">
                                <path d="M0,60 L200,60 L200,45 Q180,20 150,30 Q120,5 90,25 Q60,10 30,35 Q10,40 0,60 Z"
                                    fill="currentColor" />
                            </svg>
                        </div>
                        <!-- Set 2 -->
                        <div class="cloud-chunk" aria-hidden="true">
                            <svg class="cloud big" viewBox="0 0 200 60">
                                <path d="M0,60 L200,60 L200,45 Q180,20 150,30 Q120,5 90,25 Q60,10 30,35 Q10,40 0,60 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud massive" viewBox="0 0 300 80" style="margin-left: -80px;">
                                <path d="M0,80 L300,80 L300,55 Q260,20 210,40 Q160,5 110,45 Q60,15 30,55 Q10,65 0,80 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud medium" viewBox="0 0 160 50" style="margin-left: -70px;">
                                <path d="M0,50 L160,50 L160,35 Q130,15 100,25 Q70,5 40,30 Q10,35 0,50 Z"
                                    fill="currentColor" />
                            </svg>
                            <svg class="cloud small" viewBox="0 0 100 40" style="margin-left: -50px;">
                                <path d="M0,40 L100,40 L100,25 Q80,10 50,20 Q20,10 0,40 Z" fill="currentColor" />
                            </svg>
                            <svg class="cloud big" viewBox="0 0 200 60" style="margin-left: -60px;">
                                <path d="M0,60 L200,60 L200,45 Q180,20 150,30 Q120,5 90,25 Q60,10 30,35 Q10,40 0,60 Z"
                                    fill="currentColor" />
                            </svg>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- Background Blurs -->
    <div class="dl-blur-left"></div>
    <div class="dl-blur-right"></div>
</section>